var blogApp=angular.module("tourepedia.blog",["ui.router","tourepedia.shared"]).run(["$rootScope","Auth",function(t,e){t.$on("$stateChangeSuccess",function(o,n,l,r,a){e.loggedIn().then(function(e){console.log(e.data),t.loggedIn=e.data.loggedInStatus})})}]);!function(){angular.module("tourepedia.blog").directive("blogMenu",function(){return{restrict:"E",templateUrl:"./html/templates/menu.html"}}).directive("blogFooter",function(){return{restrict:"E",templateUrl:"./html/templates/footer.html"}}).directive("aboutTourepedia",function(){return{restrict:"E",templateUrl:"./html/templates/about-tourepedia.html"}})}(),function(){angular.module("tourepedia.blog").config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/"),t.state("home",{url:"/",views:{"section-1":{templateUrl:"./html/views/header-blogs.html"},"section-2":{templateUrl:"./html/views/more-blogs.html"}}}).state("category",{url:"/category/:category",views:{"section-1":{},"section-2":{templateUrl:"./html/views/category.html"}}}).state("blog",{url:"/:blogRecogId",views:{"section-1":{templateUrl:"./html/views/blog-read.html"},"content@blog":{templateUrl:function(t){return"./html/views/blogs/"+t.blogRecogId+".html"}},"comments@blog":{templateUrl:"./html/views/blog-read/blog-comments.html"},"aside@blog":{templateUrl:"./html/views/blog-read/blog-aside.html"},"author@blog":{templateUrl:"./html/views/blog-read/blog-author.html"},"section-2":{templateUrl:"./html/views/blog-read/blog-related.html"}}}).state("authors",{url:"/authors/:id",views:{"section-1":{templateUrl:"./html/views/author.html"},"section-2":{}}})}])}(),function(){angular.module("tourepedia.blog").controller("BlogController",["$scope","$stateParams","Blogs","Authors",function(t,e,o,n){function l(e,n){o.filteredBy("tags="+n+"&limit=1&excludeIds="+e).then(function(e){t.relatedBlogs=e.data})}function r(e){n.author(e).then(function(e){t.author=e.data})}var a=e.blogRecogId;t.blog={recogId:a},o.blog(a).then(function(e){t.blog=e.data,tags=e.data.relatedTagIds,blogId=e.data.id,l(blogId,tags),authorId=e.data.authorId,r(authorId)}),t.relatedBlogs=[],t.author={}}]).controller("RelatedBlogsController",["$scope","Blogs","$stateParams",function(t,e,o){function n(o,n,r){e.filteredBy("tags="+o+"&offset="+n+"&limit="+r+"&excludeIds="+u).then(function(e){t.relatedBlogs=t.relatedBlogs.concat(e.data)}),l(),t.loadingBlogs=!1}function l(){e.filteredBy("tags="+c+"&offset="+(r+1)+"&limit=1&excludeIds="+u).then(function(e){1!=e.data.length&&(t.moreAvailable=!1)})}t.relatedBlogs=[],t.moreAvailable=!0,t.loadingBlogs=!0;var r=0,a=1,i=o.blogRecogId,u=-1,c="";e.blog(i+"/id/relatedTagIds").then(function(t){c=t.data.relatedTagIds,u=t.data.id,n(c,r,a)}),t.loadMore=function(){t.loadingMore?console.log("please wait..."):(t.loadingBlogs=!0,console.log("loading more.."),r+=a,n(c,r,a),l())}}]).controller("HomeBlogsController",["$scope","Blogs",function(t,e){function o(){e.filteredBy("offset="+l+"&limit="+r).then(function(e){t.moreBlogs=t.moreBlogs.concat(e.data)})}function n(){e.filteredBy("offset="+(l+1)+"&limit=1").then(function(e){1!=e.data.length&&(t.moreAvailable=!1)})}var l=0,r=2;t.mainBlogs=[],t.trending=[],t.moreBlogs=[],t.moreAvailable=!0,e.main().then(function(e){t.mainBlogs=e.data}),e.trending().then(function(e){t.trending=e.data}),o(),t.loadMore=function(){t.loadingMore?console.log("please wait..."):(t.loadingBlogs=!0,console.log("loading more.."),l+=r,o(),n())}}]).controller("CategoryController",["$scope","$stateParams","Blogs",function(t,e,o){function n(){o.filteredBy("category="+r+"&offset="+a+"&limit="+i).then(function(e){t.blogs=t.blogs.concat(e.data)}),l(),t.loadingBlogs=!1}function l(){o.filteredBy("category="+r+"&offset="+(a+1)+"&limit=1").then(function(e){1!=e.data.length&&(t.moreAvailable=!1)})}var r=e.category,a=0,i=2;t.blogs=[],t.loadingBlogs=!0,t.moreAvailable=!0,n(),t.loadMore=function(){t.loadingMore?console.log("please wait..."):(t.loadingBlogs=!0,console.log("loading more.."),a+=i,n(),l())}}]).controller("AuthorsController",["$scope","Authors","$stateParams",function(t,e,o){var n=o.id;t.author={id:n},t.author.blogs=[],e.author(n).then(function(e){e.data.urls&&(e.data.urls=JSON.parse(e.data.urls)),t.author=e.data}),e.blogs(n).then(function(e){t.author.blogs=e.data})}]).controller("MenuController",["$scope","Blogs","Auth",function(t,e,o){t.blog={},t.searchResults=[];var n=4,l=0;t.search=function(){e.search("title="+t.blog.title+"&offset="+l+"&limit="+n).then(function(e){t.searchResults=e.data})},t.$watch("blog.title",function(e,o){""==e||void 0==e?t.searchResults=[]:e!=o&&t.search()}),t.removeSearch=function(){t.blog={},t.searchResults=[]},t.launchModal=function(t){console.log("launch login"),o.login(!0)}}]).controller("AccountController",["$scope","Account",function(t,e){t.userData=function(t){e.data(t).then(function(t){console.log(t.data)})},t.updateAccount=function(t,o){e.update(t,o).then(function(t){console.log(t.data)})}}])}(),function(){angular.module("tourepedia.blog").factory("Blogs",["$http","apiRoot",function(t,e){return{main:function(){return t.get(e+"/blogs.php/main")},trending:function(){return t.get(e+"/blogs.php/trending")},blog:function(o){return t.get(e+"/blogs.php/blogs/"+o)},filteredBy:function(o){return t.get(e+"/blogs.php/blogs?"+o)},search:function(o){return t.get(e+"/blogs.php/search?"+o)}}}]).factory("Authors",["$http","apiRoot",function(t,e){return{author:function(o){return t.get(e+"/authors.php/authors/"+o)},blogs:function(o){return t.get(e+"/blogs.php/blogs?authorId="+o)}}}]).service("Account",["$http","apiRoot",function(t,e){return{data:function(o){return t.get(e+"/users/index.php/data/"+o)},update:function(o,n){return t.put(e+"/users/index.php/update/"+o,n)}}}])}(),function(){angular.module("tourepedia.blog").directive("blogInfo",[function(){return{restrict:"AE",replace:!0,scope:{blog:"="},templateUrl:"./html/templates/blog-info.html"}}])}(),function(){angular.module("tourepedia.blog").directive("slider",["$timeout",function(t){return{restrict:"AE",replace:!0,scope:{items:"="},link:function(e,o,n){function l(){i=t(function(){e.next(),i=t(l,5e3)},5e3)}function r(){e.$watch("currentIndex",function(t,o){e.items.forEach(function(t){t.visible=!1}),e.items[t].visible=!0})}var a=e.$watch("items",function(t,e){t&&0!=t.length&&(r(),a())});e.currentIndex=0,e.next=function(){e.currentIndex<e.items.length-1?e.currentIndex++:e.currentIndex=0},e.prev=function(){e.currentIndex>0?e.currentIndex--:e.currentIndex=e.items.length-1};var i;l(),e.$on("$destroy",function(){t.cancel(i)})},templateUrl:"./html/templates/blog-slider.html"}}])}();